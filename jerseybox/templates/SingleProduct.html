{%extends 'base.html'%} {%block content%} {%load static%} {%csrf_token%}

<section class="py-20">
  <div class="container px-4 mx-auto">
    <div class="max-w-xl lg:max-w-6xl mx-auto">
      <div class="flex flex-wrap -mx-4 mb-12">
        <div class="w-full lg:w-1/2 px-4 mb-12 lg:mb-0">
          <div class="lg:w-112">
            
            <div class="flex flex-row -mx-3 -mb-3 justify-between">
            {% for image in images %}
              <a
                class="relative group block h-80 w-full bg-blueGray-900 rounded-md"
                href="#"
              >
                <div
                  class="image-container  hover:scale-125 absolute top-0 left-0 h-full w-full transform -translate-y-1 -translate-x-1 group-hover:translate-y-0 group-hover:translate-x-0 transition duration-300"
                >
                  <img src="{{ image.image.url }}" alt="{{ image.product_id.product_id.name }} class='w-full h-auto' " />
                </div>
              </a>
            {% endfor %} 
             
       {% comment %} <div class="flex flex-wrap -mx-4">
        {% for image_url in image_urls %}
        <div class="w-1/2 md:w-1/3 lg:w-1/4 xl:w-1/6 p-4">
            <div class="image-container relative overflow-hidden transform transition-transform duration-300 hover:scale-125">
                <img src="{{ image_url }}" alt="Image {{ forloop.counter }}" class="w-full h-auto">
            </div>
        </div>
        {% endfor %}
        </div> {% endcomment %}

            </div>
          </div>
        </div>
        <div class="w-full lg:w-1/2 px-4">
          <div class="max-w-lg">
            <h2 class="text-4xl font-black mb-1">{{product.name }}</h2>

            <div class="flex items-center mb-4">
              
              
            </div>
            <div class='flex'>
            <p class="text-lg font-semibold text-black cursor-auto my-3">
              {{product.price}}₹
            </p>
            <del>
              {% comment %} <p class="text-sm text-gray-600 cursor-auto ml-2 my-3">
                {{product.actual_price}}₹
              </p> {% endcomment %}
            </del>
            <div>
            {% comment %} <p class="text-lg ml-4 font-semibold text-red-500 cursor-auto my-3">
              {{product.discount_percent}}%
            </p> {% endcomment %}
            </div>
            </div>
            <div class="flex flex-wrap mb-4">
             
              <div class="w-full sm:w-auto">
                <span class="block text-sm font-black mb-2">Size</span>
                <div
                  class="group relative h-12 w-32 border-2 border-black rounded-md overflow-hidden"
                >
 <!-- Add this code to your SingleProduct.html template -->
{% comment %} <form id="size-form" method="post">
  {% csrf_token %}
  <select
    class="w-full h-full px-4 text-sm font-bold appearance-none outline-none"
    name="selected_size"
    id="size-select"
  >
    <option value="">Select Size</option>
    <option value="S">Small</option>
    <option value="M">Medium</option>
    <option value="L">Large</option>
  </select>
  <button type="submit" style="display: none;"></button>
</form>

<button id="add-to-cart-button" style="display: none;"></button> {% endcomment %}

<form id="size-form" method="post">
  {% csrf_token %}
  <select
    class="w-full h-full px-4 text-sm font-bold appearance-none outline-none"
    name="selected_size"
    id="size-select"
  >
    <option value="">Select Size</option>
    <option value="S">Small</option>
    <option value="M">Medium</option>
    <option value="L">Large</option>
  </select>
  



                  <span
                    class="absolute top-1/2 right-0 mr-3 transform -translate-y-1/2 text-black group-hover:text-indigo-500"
                  >
                    <svg
                      width="10"
                      height="6"
                      viewbox="0 0 10 6"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M8.94667 0.453308H4.79333H1.05333C0.413333 0.453308 0.0933335 1.22664 0.546667 1.67997L4 5.13331C4.55333 5.68664 5.45333 5.68664 6.00667 5.13331L7.32 3.81997L9.46 1.67997C9.90667 1.22664 9.58667 0.453308 8.94667 0.453308Z"
                        fill="currentColor"
                      ></path>
                    </svg>
                  </span>
                </div>
              </div>

              <input
  type="number"
  class="w-full h-full px-4 text-sm font-bold appearance-none outline-none"
  name="quantity"
  id="quantity" 
  value="1"
  min="1"
>
            </div>
            <div class="flex flex-wrap sm:flex-nowrap items-center -mx-2 mb-6">
              <div class="flex-grow-1 w-full px-2 mb-4">
  
  

  <a id="add-to-cart-button"
    class="group relative inline-block h-12 w-full -mb-2 bg-blueGray-900 rounded-md add-to-cart-link" 
    href="#">
    <div
      class="absolute top-0 left-0 transform -translate-y-1 -translate-x-1 w-full h-full group-hover:translate-y-0 group-hover:translate-x-0 transition duration-300"
    >
      <div
        class="flex h-full w-full items-center justify-center bg-green-600 border-2 border-black rounded-md"
      >
        <span class="text-base font-black text-black">Add to Cart</span>
      </div>
    </div>
  </a>
</div>
<p>Quantity: {{ request.POST.quantity }}</p>

</form>

              <div class="w-auto px-2 mb-4">
                <a
                  class="inline-flex items-center justify-center w-12 h-12 text-black hover:text-indigo-500 border-2 border-black hover:border-indigo-500 rounded-md transition duration-200"
                  href="#"
                >
                  <svg
                    width="20"
                    height="18"
                    viewbox="0 0 20 18"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M14.44 0.0999756C12.63 0.0999756 11.01 0.979976 10 2.32998C8.99 0.979976 7.37 0.0999756 5.56 0.0999756C2.49 0.0999756 0 2.59998 0 5.68998C0 6.87998 0.19 7.97998 0.52 8.99998C2.1 14 6.97 16.99 9.38 17.81C9.72 17.93 10.28 17.93 10.62 17.81C13.03 16.99 17.9 14 19.48 8.99998C19.81 7.97998 20 6.87998 20 5.68998C20 2.59998 17.51 0.0999756 14.44 0.0999756Z"
                      fill="currentColor"
                    ></path>
                  </svg>
                </a>
              </div>
              <div class="w-auto px-2 mb-4">
      
              </div>
            </div>
            
          
          </div>
        </div>
      </div>
      <div class="mb-8 border-b-2 border-black">
        <div class="flex flex-col md:flex-row -mb-px">
          <a
            class="inline-block px-2 pb-2 mb-3 md:mb-0 text-lg font-black text-indigo-500 border-b-4 border-indigo-500"
            href="#"
            >Description</a
          >
        </div>
      </div>
      <div>
        <p class="text-lg font-bold">{{product.description}}</p>
      </div>
    </div>
  </div>
</section>

<script>
        const imageContainers = document.querySelectorAll('.image-container');

        imageContainers.forEach((container) => {
            const image = container.querySelector('img');

            container.addEventListener('mousemove', (e) => {
                const { left, top, width, height } = container.getBoundingClientRect();
                const x = (e.clientX - left) / width;
                const y = (e.clientY - top) / height;

                image.style.transformOrigin = `${x * 100}% ${y * 100}%`;
                image.style.transform = 'scale(1.1)'; // Adjust the scale factor here
            });

            container.addEventListener('mouseleave', () => {
                image.style.transform = 'scale(1)'; // Reset the scale to normal size
            });
        });
    </script>

    {% comment %} <script>
  const sizeSelect = document.getElementById('size-select');
  const sizeForm = document.getElementById('size-form');
  const addToCartLink = document.querySelector('.add-to-cart-link'); // Change this selector to match your anchor element

  // Event listener for size selection change
  sizeSelect.addEventListener('change', function () {
    // Enable or disable the "Add to Cart" link based on whether a size is selected
    if (sizeSelect.value) {
      // Enable the link by adding the URL
      addToCartLink.href = "{% url 'add_to_cart' product.id %}?size=" + sizeSelect.value;
    } else {
      // Disable the link by removing the href attribute
      addToCartLink.removeAttribute('href');
    }
  });
</script> {% endcomment %}
<script>
document.addEventListener('DOMContentLoaded', function () {
  const sizeSelect = document.getElementById('size-select');
  const quantityInput = document.getElementById('quantity');
  const sizeForm = document.getElementById('size-form');
  const addToCartButton = document.getElementById('add-to-cart-button');

  // Listen for changes in the size select dropdown
  sizeSelect.addEventListener('change', function (event) {
    event.preventDefault(); // Prevent the default form submission behavior
  });

  // Listen for clicks on the "Add to Cart" button
  addToCartButton.addEventListener('click', function (event) {
    event.preventDefault(); // Prevent the default button behavior
    
    // Check if a size is selected (optional, you can add validation here)
    if (sizeSelect.value) {
      // Check if a quantity is entered
      const quantity = parseInt(quantityInput.value);
      if (!isNaN(quantity) && quantity > 0) {
        // Set the selected size and quantity as hidden input fields in the form
        const selectedSizeInput = document.createElement('input');
        selectedSizeInput.type = 'hidden';
        selectedSizeInput.name = 'selected_size';
        selectedSizeInput.value = sizeSelect.value;
        sizeForm.appendChild(selectedSizeInput);

        // Set the quantity as a hidden input field in the form
        const quantityInputClone = document.createElement('input');
        quantityInputClone.type = 'hidden';
        quantityInputClone.name = 'quantity';
        quantityInputClone.value = quantity;
        sizeForm.appendChild(quantityInputClone);

        // Submit the form
        sizeForm.submit();
      } else {
        alert('Please enter a valid quantity.');
      }
    } else {
      alert('Please select a size.');
    }
  });
});

</script>



{% endblock %}
